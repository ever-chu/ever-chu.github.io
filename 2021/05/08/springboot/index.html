

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Chu">
  <meta name="keywords" content="">
  
  <title>springboot - ever的个人博客</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.6.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/gundongtiao.css# 滚动条颜色.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css# 鼠标指针.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Chu</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- 天气网 -->
	<!--添加天气，url=https://cj.weather.com.cn/ -->
<iframe width="210" scrolling="no" height="60" frameborder="0" allowtransparency="true" src="https://i.tianqi.com?c=code&id=12&color=%23C6C6C6&icon=3&num=1&site=12"></iframe>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                主页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                存档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="springboot">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-05-08 16:31" pubdate>
        2021年5月8日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      12.2k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      182
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">springboot</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：13 分钟前
                
              </p>
            
            <div class="markdown-body">
              <h2 id="一-SpringBoot入门"><a href="#一-SpringBoot入门" class="headerlink" title="一.SpringBoot入门"></a>一.SpringBoot入门</h2><h3 id="1-0-springboot简介"><a href="#1-0-springboot简介" class="headerlink" title="1.0 springboot简介"></a>1.0 springboot简介</h3><ul>
<li><p><strong>SpringBoot介绍</strong><br>先通过来一些概念，会让我们对技术有着更加清晰的理解。J2EE笨重的开发、繁多的配置、低下的开发效率、复杂的部署流程、第三方技术集成难度大，如果开发过SpringMVC或者单纯使用过SSH、SSM框架的同学，肯定是体验过被很多配置文件支配的恐惧，很难受吧，不过不用担心，我们有了SpringBoot。Spring Boot用来简化Spring应用开发，约定大于配置，去繁从简，just run就能创建一个独立的，产品级别的应用。</p>
</li>
<li><p><strong>SpringBoot优点</strong></p>
<blockquote>
<p>1.可快速构建独立的Spring应用<br>2.直接嵌入Tomcat、Jetty和Undertow服务器<br>3.通过依赖启动器简化构建配置<br>4.自动化配置Spring和第三方库<br>5.提供生产就绪功能<br>6.极少的代码生成和XML配置</p>
</blockquote>
</li>
</ul>
<h3 id="1-1-实现HelloWorld应用"><a href="#1-1-实现HelloWorld应用" class="headerlink" title="1.1 实现HelloWorld应用"></a>1.1 实现HelloWorld应用</h3><ul>
<li>1.环境说明(这是我自己的版本)<blockquote>
<p>JDK1.8：1.8的版本很好用，目前大部分公司生产环境的项目也都是1.8<br>SpringBoot2：我这里使用的SpringBoot2.3.4<br>Maven3.3以上：我这里使用的是3.6.3<br>IDEA2020.2: 我这里使用的是IDEA，自己也可以使用eclipse</p>
</blockquote>
</li>
<li>2.maven添加阿里云镜像(加快依赖jar包下载)<br><font color="orange">maven -&gt; config -&gt; settings.xml</font> 找到mirrors标签，在里面添加以下配置<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;mirror&gt;<br>	&lt;id&gt;alimaven&lt;/id&gt;<br>	&lt;mirrorOf&gt;central&lt;/mirrorOf&gt;<br>	&lt;name&gt;aliyun maven&lt;/name&gt;<br>	&lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;<br>&lt;/mirror&gt;<br></code></pre></td></tr></table></figure></li>
<li>3.完成了上述操作之后，现在我教你用Idea配置自己的Maven，具体操作如下图：<br><img src="https://img.wenhairu.com/images/2021/05/12/aTza0.png" srcset="/img/loading.gif" lazyload alt="1.1.0"><br><img src="https://img.wenhairu.com/images/2021/05/10/aOiIq.png" srcset="/img/loading.gif" lazyload alt="1.1.1"><br>选择好了之后，点击Apply就可以了。</li>
<li>4.搭建springboot应用<br>首先我们使用Idea创建Maven工程<br><img src="https://img.wenhairu.com/images/2021/05/12/aTjPU.png" srcset="/img/loading.gif" lazyload alt="1.1.2"><br><img src="https://img.wenhairu.com/images/2021/05/10/aO3Ep.png" srcset="/img/loading.gif" lazyload alt="1.1.3"><br><img src="https://img.wenhairu.com/images/2021/05/10/aOrg6.png" srcset="/img/loading.gif" lazyload alt="1.1.4"><br><img src="https://img.wenhairu.com/images/2021/05/10/aOt3I.png" srcset="/img/loading.gif" lazyload alt="1.1.5"><br>然后点击Finish就创建成功了，我们的Maven项目也就创建好了，这里要提一下，我们刚创建Maven项目的时候，Idea给我的一些Tip，我们把这个勾选了，以后我们修改pom.xml的时候，就会自动帮我们加载依赖了。<br><img src="https://img.wenhairu.com/images/2021/05/12/aTLtj.png" srcset="/img/loading.gif" lazyload alt="1.1.6"><br><img src="https://img.wenhairu.com/images/2021/05/12/aTlJg.png" srcset="/img/loading.gif" lazyload alt="1.1.7"><br>到这里我们的springboot项目就创建完成了</li>
<li>4.编写一个主程序，启动springboot应用<br>现在创建一个包，在包下创建一个java类，命名随便，我这里命名为DemoApplication ，如下图，编写的代码如下：<br><img src="https://img.wenhairu.com/images/2021/05/12/aTvoK.png" srcset="/img/loading.gif" lazyload alt="1.1.8"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoApplication</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(DemoApplication.class, args);<br>    &#125;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;name&quot;, defaultValue = &quot;World&quot;)</span> String name)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">&quot;Hello %s!&quot;</span>, name);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
代码写好了就直接运行吧，你没听错，啥都不用做，直接运行就好了，运行了之后，直接在浏览器中访问，你就会发现成功了，舒不舒服。<br><img src="https://img.wenhairu.com/images/2021/05/12/aTxd3.png" srcset="/img/loading.gif" lazyload alt="1.1.9"><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/DBC_121/article/details/104383089?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162052898116780262592032%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162052898116780262592032&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_yy~default-1-104383089.pc_search_result_hbase_insert&utm_term=springbott">原文章链接</a></li>
</ul>
<h3 id="1-1-单元测试"><a href="#1-1-单元测试" class="headerlink" title="1.1 单元测试"></a>1.1 单元测试</h3><ul>
<li>1.添加测试依赖启动器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"> &lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;<br>	&lt;scope&gt;<span class="hljs-built_in">test</span>&lt;/scope&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li>
<li>2.编写单元测试类和测试方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.chu.domain.Example;<br><span class="hljs-keyword">import</span> com.chu.domain.Person;<br><span class="hljs-keyword">import</span> com.chu.domain.Person1;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class="hljs-meta">@SpringBootTest</span> <span class="hljs-comment">//标记单元测试类，并加载项目的上下文环境ApplicationContext</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span> <span class="hljs-comment">//测试运行器，并加载Spring Boot测试注解</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApplicationTests</span> </span>&#123;<br>    <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(person1.getId());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-2-yaml语法"><a href="#1-2-yaml语法" class="headerlink" title="1.2 yaml语法"></a>1.2 yaml语法</h3><ul>
<li>1.导入yaml提示依赖<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- 通过本依赖可以提示yaml文件，自定义的属性 --&gt;<br>&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;<br>	&lt;optional&gt;<span class="hljs-literal">true</span>&lt;/optional&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li>
<li>2.创建application.yaml(springboot会自动识别)和实体类，我们可以在yaml文件中配置一些属性在应用启动时自动给实体类注入属性(请注意yaml的文件格式：application.yaml文件使用 <strong>“key”:(空格)value</strong>格式配置属性)<br><img src="https://img.wenhairu.com/images/2021/05/10/aOx1t.png" srcset="/img/loading.gif" lazyload alt="1.2.0"><br><font color="orange">application.yaml</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">person:<br>  userName: zhangsan<br>  boss: <span class="hljs-literal">true</span><br>  birth: 2020/1/12<br>  age: 18<br><span class="hljs-comment">#  interests: [篮球,足球]</span><br>  interests:<br>    - 篮球<br>    - 足球<br>  animal: [阿猫,阿狗]<br><span class="hljs-comment">#  score:</span><br><span class="hljs-comment">#    english: 80</span><br><span class="hljs-comment">#    math: 90</span><br>  score: &#123;english:80,math:90&#125;<br>  salarys:<br>    - 999.9<br>    - 9999.9<br>  pet:<br>    name: 阿狗<br>  allPets:<br>    sick:<br>      - &#123;name: 阿狗&#125;<br>      - name: 阿猫<br>      - name: 啊虫<br>    health:<br>      - name: 阿花<br>      - name: 阿浪<br><br></code></pre></td></tr></table></figure>
<font color="orange">Person.java</font><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.PropertySource;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.PropertySources;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><span class="hljs-keyword">import</span> java.util.Set;<br><span class="hljs-comment">//@PropertySource(value = &quot;classpath:xxx.properties&quot;) 记载指定配置文件</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String userName;<br>    <span class="hljs-keyword">private</span> Boolean boss;<br>    <span class="hljs-keyword">private</span> Date birth;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Pet pet;<br>    <span class="hljs-keyword">private</span> String[] interests;<br>    <span class="hljs-keyword">private</span> List&lt;String&gt; animal;<br>    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; score;<br>    <span class="hljs-keyword">private</span> Set&lt;Double&gt; salarys;<br>    <span class="hljs-keyword">private</span> Map&lt;String, List&lt;Pet&gt;&gt; allPets;<br>&#125;<br><span class="hljs-comment">//...此处省略setter、getter方法</span><br></code></pre></td></tr></table></figure></li>
<li>3.编写单元测试类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> com.chu.domain.Person;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApplicationTests</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span> <span class="hljs-comment">//获取person组件</span><br>    <span class="hljs-keyword">private</span> Person person;<br>	<br>	<span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(person);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-3-常用注解总结"><a href="#1-3-常用注解总结" class="headerlink" title="1.3 常用注解总结"></a>1.3 常用注解总结</h3><ul>
<li><font color="orange">@RestController</font>：@RestController 注解告诉Spring以字符串的形式渲染结果，并直接返回给调用者。@Controller和@Responsebody结合</li>
<li><font color="orange">@RequestMapping</font>：注解提供路由信息。它告诉Spring任何来自”/“路径的HTTP请求都应该被映射到 home 方法。</li>
<li><strong>注意</strong>：@RestController和@RequestMapping注解是Spring MVC注解</li>
<li><font color="orange">@EnableAutoConfiguration</font>：就是Springboot根据你添加的jar包来配置你项目的默认配置，比如根据spring-boot-starter-web ，来判断你的项目是否需要添加了webmvc和tomcat，就会自动的帮你配置web项目中所需要的默认配置。</li>
<li><font color="orange">@Configuration</font>：告诉SpringBoot这是一个配置类 == 配置文件</li>
<li><font color="orange">@ConditionalOnBean(name = “tomcat”)</font>：条件装配。如果放在方法上时表示只有容器中有某个组件才给下面所有都生效，否则都不生效。</li>
<li><font color="orange">@ConfigurationProperties(prefix = “person”)</font>：它可以将 application.yml 或 application.properties 主配置文件中的属性值与 Java Bean 对应属性进行注入。</li>
<li><font color="orange">@PropertySource</font>：去加载指定的配置文件，然后结合 @ConfigurationProperties 注解，便能够实现指定配置文件与 Java Bean 的注入操作。</li>
<li><font color="orange">@EnableAutoConfiguration</font>：开启自动配置</li>
<li><font color="orange">@ComponentScan(param)</font>：告诉Spring 哪个packages 的用注解标识的类 会被spring自动扫描并且装入bean容器,param即用来指定扫描包的范围。</li>
<li><font color="orange">@SpringBootApplication</font>：启动类，注解等价于以默认属性使用 @Configuration ， @EnableAutoConfiguration 和 @ComponentScan</li>
<li><font color="orange">@ResponseBody</font>：表示该方法的返回结果直接写入HTTP response body中</li>
<li><font color="orange">@Component</font>：泛指组件，可以将类注册到容器中</li>
<li><font color="orange">@AutoWired</font>：造函数进行标注，完成自动装配的工作。当加上（required=false）时，就算找不到bean也不报错。</li>
<li><font color="orange">@RequestParam(value=”参数名”,required=”true/false”,defaultValue=””)</font>：将请求参数绑定到你控制器的方法参数上（是springmvc中接收普通参数的注解）</li>
<li><font color="orange">@PathVariable</font>：接收请求路径中占位符的值<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"> &lt;a href=&quot;car/3/owner/lisi?age=18&amp;inters=basketball&amp;inters=game&quot;&gt;car/&#123;id&#125;/owner/&#123;username&#125;&lt;/a&gt;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@PathVariable</span>注解可将有当前注解的属性封装到map中，但是map的k、v必须都是String类型</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> id</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> name</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> kv</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">  */</span><br> <span class="hljs-meta">@GetMapping(&quot;/car/&#123;id&#125;/owner/&#123;username&#125;&quot;)</span><br> <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String,Object&gt; <span class="hljs-title">getCar</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-meta">@PathVariable(&quot;username&quot;)</span> String name,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-meta">@PathVariable</span> Map&lt;String,String&gt; kv,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-meta">@RequestParam(&quot;age&quot;)</span> Integer age,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-meta">@RequestParam(&quot;inters&quot;)</span> List&lt;String&gt; inters)</span></span>&#123;<br>     Map&lt;String,Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>     map.put(<span class="hljs-string">&quot;id&quot;</span>,id);<br>     map.put(<span class="hljs-string">&quot;name&quot;</span>,name);<br>     map.put(<span class="hljs-string">&quot;kv&quot;</span>,kv);<br>     map.put(<span class="hljs-string">&quot;age&quot;</span>,age);<br>     map.put(<span class="hljs-string">&quot;inters&quot;</span>,inters);<br>     <span class="hljs-keyword">return</span> map;<br> &#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-4-自定义REST风格"><a href="#1-4-自定义REST风格" class="headerlink" title="1.4 自定义REST风格"></a>1.4 自定义REST风格</h3><ul>
<li>1.在配置类自定义REST风格的name属性<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> HiddenHttpMethodFilter <span class="hljs-title">hiddenHttpMethodFilter</span><span class="hljs-params">()</span></span>&#123;<br>	HiddenHttpMethodFilter methodFilter = <span class="hljs-keyword">new</span> HiddenHttpMethodFilter();<br>	<span class="hljs-comment">//自定义参数，html提交必须的name属性，默认为_method</span><br>	methodFilter.setMethodParam(<span class="hljs-string">&quot;_chu&quot;</span>);<br>	<span class="hljs-keyword">return</span> methodFilter;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>2.页面表单(index.html)<br>浏览器支持get、post提交，所以我们只需要模拟put、delete<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">测试REST风格:<br>&lt;form action=<span class="hljs-string">&quot;/user&quot;</span> method=<span class="hljs-string">&quot;get&quot;</span>&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;REST-GET提交&quot;</span>&gt;<br>&lt;/form&gt;<br><br>&lt;form action=<span class="hljs-string">&quot;/user&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;REST-POST提交&quot;</span>&gt;<br>&lt;/form&gt;<br><br>&lt;form action=<span class="hljs-string">&quot;/user&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    &lt;!--&lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;_method&quot;</span> value=<span class="hljs-string">&quot;delete&quot;</span>&gt;--&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;_chu&quot;</span> value=<span class="hljs-string">&quot;delete&quot;</span>&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;REST-DELETE提交&quot;</span>&gt;<br>&lt;/form&gt;<br><br>&lt;form action=<span class="hljs-string">&quot;/user&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    &lt;!--&lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;_method&quot;</span> value=<span class="hljs-string">&quot;PUT&quot;</span>&gt;--&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;_chu&quot;</span> value=<span class="hljs-string">&quot;PUT&quot;</span>&gt;<br>    &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;REST-PUT提交&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure></li>
<li>3.接受提交数据(name=”_chu”和value值来判断)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">package com.chu.boot.controller;<br><br>import org.springframework.web.bind.annotation.*;<br><br>@RestController<br>public class HelloController &#123;<br><br>    /**<br>     * 请求进来，先去找Controller看能不能处理。不能处理的所有请求有都交给静态资源处理器。静态资源也找不到时404<br>     * @<span class="hljs-built_in">return</span><br>     */<br>    @RequestMapping(<span class="hljs-string">&quot;/time.jpg&quot;</span>)<br>    public String <span class="hljs-function"><span class="hljs-title">hello</span></span>()&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;aaa&quot;</span>;<br>    &#125;<br><br>    //@RequestMapping(value = <span class="hljs-string">&quot;/user&quot;</span>,method = RequestMethod.GET)<br>    @GetMapping(<span class="hljs-string">&quot;/user&quot;</span>)<br>    public String <span class="hljs-function"><span class="hljs-title">getUser</span></span>()&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;GET-张三&quot;</span>;<br>    &#125;<br><br>    //@RequestMapping(value = <span class="hljs-string">&quot;/user&quot;</span>,method = RequestMethod.POST)<br>    @PostMapping(<span class="hljs-string">&quot;user&quot;</span>)<br>    public String <span class="hljs-function"><span class="hljs-title">saveUser</span></span>()&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;POST-张三&quot;</span>;<br>    &#125;<br><br><br>    //@RequestMapping(value = <span class="hljs-string">&quot;/user&quot;</span>,method = RequestMethod.PUT)<br>    @PutMapping(<span class="hljs-string">&quot;/user&quot;</span>)<br>    public String <span class="hljs-function"><span class="hljs-title">putUser</span></span>()&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;PUT-张三&quot;</span>;<br>    &#125;<br><br>    //@RequestMapping(value = <span class="hljs-string">&quot;/user&quot;</span>,method = RequestMethod.DELETE)<br>    @DeleteMapping(<span class="hljs-string">&quot;/user&quot;</span>)<br>    public String <span class="hljs-function"><span class="hljs-title">deleteUser</span></span>()&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;DELETE-张三&quot;</span>;<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-5-JSR303数据校验"><a href="#1-5-JSR303数据校验" class="headerlink" title="1.5 JSR303数据校验"></a>1.5 JSR303数据校验</h3><ul>
<li>@ConfigurationProperties 注解注入配置文件属性值时,支持JSR303数据校验，其主要作用是校验配置文件中注入对应Bean属性的值是否符合相关值的规则。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.validation.annotation.Validated;<br><br><span class="hljs-keyword">import</span> javax.validation.constraints.Email;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><span class="hljs-meta">@Validated</span> <span class="hljs-comment">//引入Spring框架支持的数据校验规则</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>&#123;<br>    <span class="hljs-meta">@Email</span> <span class="hljs-comment">//对属性进行规则匹配</span><br>    <span class="hljs-keyword">private</span> String email;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getEmail</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> email;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEmail</span><span class="hljs-params">(String email)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.email = email;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-6-拦截器的简单实现"><a href="#1-6-拦截器的简单实现" class="headerlink" title="1.6 拦截器的简单实现"></a>1.6 拦截器的简单实现</h3><ul>
<li>1.实现HandlerInterceptor接口实现拦截器(我的这个案例主要是拦截用户是否登录,主要展示后台代码)<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 登录检查</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 目标方法执行之前</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> response</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> handler</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">//获取session对象</span><br>		HttpSession session = request.getSession();<br>		<span class="hljs-comment">//获取session中已经存储的key并拿到user用户</span><br>        Object user = session.getAttribute(<span class="hljs-string">&quot;user&quot;</span>);<br>		<span class="hljs-comment">//判断当前用户是否存在</span><br>        <span class="hljs-keyword">if</span>(user!=<span class="hljs-keyword">null</span>)&#123;<br>		    <span class="hljs-comment">//存在放行</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>		    <span class="hljs-comment">//否则跳转到登录页面</span><br>            <span class="hljs-comment">/*request.setAttribute(&quot;msg&quot;,&quot;请先登录&quot;);*/</span><br>            request.getRequestDispatcher(<span class="hljs-string">&quot;/&quot;</span>).forward(request,response);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 目标方法执行完以后</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> response</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> handler</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> modelAndView</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 页面渲染之后</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> response</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> handler</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ex</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
<li>2.添加到配置类中并进行Bean注册<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>	registry.addInterceptor(<span class="hljs-keyword">new</span> LoginInterceptor())<br>	        <span class="hljs-comment">//添加拦截的路径</span><br>			.addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>			<span class="hljs-comment">//添加放行的路径(一般都放行静态文件)</span><br>			.excludePathPatterns(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;/login&quot;</span>,<span class="hljs-string">&quot;/css/**&quot;</span>,<span class="hljs-string">&quot;/fonts/**&quot;</span>,<span class="hljs-string">&quot;/images/**&quot;</span>,<span class="hljs-string">&quot;/js/**&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-7-自定义banner-txt"><a href="#1-7-自定义banner-txt" class="headerlink" title="1.7 自定义banner.txt"></a>1.7 自定义banner.txt</h3><ul>
<li>我们在启动springboot启动类的时候，控制台会打印以下输出图样<br><img src="https://img.wenhairu.com/images/2021/05/12/aV8Fo.png" srcset="/img/loading.gif" lazyload alt="1.8.0"></li>
<li>其实我们可以改变他的默认输出图样并设置成我们自己喜欢的图样<br><img src="https://img.wenhairu.com/images/2021/05/12/aVmTd.png" srcset="/img/loading.gif" lazyload alt="1.8.1"></li>
<li>这样就成功啦!!!<br><img src="https://img.wenhairu.com/images/2021/05/12/aVqxH.png" srcset="/img/loading.gif" lazyload alt="1.8.2"></li>
</ul>
<h3 id="1-8-配置favicon-ico小图标"><a href="#1-8-配置favicon-ico小图标" class="headerlink" title="1.8 配置favicon.ico小图标"></a>1.8 配置favicon.ico小图标</h3><ul>
<li>本节分享设置项目logo，我们默认的项目访问后并没有任何图标<blockquote>
<p>1.我们自己的<br><img src="https://img.wenhairu.com/images/2021/05/12/aVNuq.png" srcset="/img/loading.gif" lazyload alt="2.0"><br>2.csdn的logo<br><img src="https://img.wenhairu.com/images/2021/05/12/aVYPX.png" srcset="/img/loading.gif" lazyload alt="2.0.0"><br>3.设置自定义logo，在页面引入<br><img src="https://img.wenhairu.com/images/2021/05/12/aVfzp.png" srcset="/img/loading.gif" lazyload alt="2.0.1"><br><img src="https://img.wenhairu.com/images/2021/05/12/aVCK6.png" srcset="/img/loading.gif" lazyload alt="2.0.2"><br>4.访问我们的页面就配置成功啦!!!<br><img src="https://img.wenhairu.com/images/2021/05/12/aVJoI.png" srcset="/img/loading.gif" lazyload alt="2.0.3"></p>
</blockquote>
</li>
</ul>
<h2 id="二-SpringBoot视图技术"><a href="#二-SpringBoot视图技术" class="headerlink" title="二.SpringBoot视图技术"></a>二.SpringBoot视图技术</h2><h3 id="2-0-配置视图控制器"><a href="#2-0-配置视图控制器" class="headerlink" title="2.0 配置视图控制器"></a>2.0 配置视图控制器</h3><ul>
<li>我们通过Controller控制层RequestMapping映射路径时，我们可能想要隐藏某个方法的真实路径，可以通过配置addViewControllers来通过虚拟路径访问真实路径。创建配置类实现WebMvcConfigurer接口，重写addViewControllers方法。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">@Configuration<br>public class MyWebConfig implements WebMvcConfigurer &#123;<br>    /**<br>     * 添加视图控制器<br>     * @param registry<br>     */<br>    @Override<br>    public void addViewControllers(ViewControllerRegistry registry) &#123;<br>        registry.addViewController(<span class="hljs-string">&quot;/&quot;</span>).setViewName(<span class="hljs-string">&quot;index&quot;</span>);<br>        registry.addViewController(<span class="hljs-string">&quot;/index.html&quot;</span>).setViewName(<span class="hljs-string">&quot;index&quot;</span>);<br>        registry.addViewController(<span class="hljs-string">&quot;/dashboard.html&quot;</span>).setViewName(<span class="hljs-string">&quot;dashboard&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-1-i18n国际化"><a href="#2-1-i18n国际化" class="headerlink" title="2.1 i18n国际化"></a>2.1 i18n国际化</h3><ul>
<li><p><font color="orange"><strong>步骤</strong></font> 在配置类中加载开启国际化</p>
<blockquote>
<p>1.实现LocaleResolver接口实现国际化的转换</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java">   <span class="hljs-keyword">package</span> com.chu.config;<br><br><span class="hljs-keyword">import</span> org.springframework.util.ObjectUtils;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.util.Locale;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 实现LocaleResolver接口实现国际化的转换</span><br><span class="hljs-comment"> * 底层AcceptHeaderLocaleResolver实现了LocaleResolver重写了resolveLocale方法</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyLocaleResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">LocaleResolver</span> </span>&#123;<br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Locale <span class="hljs-title">resolveLocale</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br>		<span class="hljs-comment">//获取请求中的语言参数</span><br>		String language = request.getParameter(<span class="hljs-string">&quot;l&quot;</span>);<br>		<span class="hljs-comment">//如果没有就使用默认的</span><br>		Locale locale = Locale.getDefault();<br><br>		<span class="hljs-comment">//如果请求的链接携带了国际化的参数</span><br>		<span class="hljs-keyword">if</span>(!ObjectUtils.isEmpty(language))&#123;<br>			<span class="hljs-comment">//zh_CN</span><br>			String[] strings = language.split(<span class="hljs-string">&quot;_&quot;</span>);<br>			<span class="hljs-comment">//国家,地区</span><br>			locale = <span class="hljs-keyword">new</span> Locale(strings[<span class="hljs-number">0</span>],strings[<span class="hljs-number">1</span>]);<br>		&#125;<br>		<span class="hljs-keyword">return</span> locale;<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setLocale</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Locale locale)</span> </span>&#123;<br><br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<blockquote>
<p>2.加载到配置类中，并进行@Bean注册</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title">localeResolver</span><span class="hljs-params">()</span></span>&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyLocaleResolver();<br>  &#125;<br></code></pre></td></tr></table></figure></li>
<li><p>创建需要存储转换英文和中文的properties文件<br><img src="https://img.wenhairu.com/images/2021/05/10/aTqgR.png" srcset="/img/loading.gif" lazyload alt="1.6.0"></p>
<blockquote>
<p>login.properties</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">login.password=密码<br>login.tip=登录<br>login.username=用户名<br></code></pre></td></tr></table></figure>
<blockquote>
<p>login_en_US.properties</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">login.password=Password<br>login.tip=Sign In<br>login.username=User ID<br></code></pre></td></tr></table></figure>
<blockquote>
<p>login_zh_CN.properties</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">login.password=密码<br>login.tip=登录<br>login.username=用户名<br></code></pre></td></tr></table></figure></li>
<li><p>html需要的数据<br><img src="https://img.wenhairu.com/images/2021/05/10/aTFrN.png" srcset="/img/loading.gif" lazyload alt="1.6.1"></p>
</li>
<li><p>到这里国际化的配置就结束了让我们一起来看看实现的效果。<br><img src="https://img.wenhairu.com/images/2021/05/10/aTYwB.png" srcset="/img/loading.gif" lazyload alt="1.6.2"><br><img src="https://img.wenhairu.com/images/2021/05/10/aTfRn.png" srcset="/img/loading.gif" lazyload alt="1.6.3"></p>
</li>
</ul>
<h3 id="2-2-整合Thymeleaf"><a href="#2-2-整合Thymeleaf" class="headerlink" title="2.2 整合Thymeleaf"></a>2.2 整合Thymeleaf</h3><p>&nbsp;&nbsp;<strong>1.表达式基本了解</strong></p>
<ul>
<li><p>它是一种用于Web和独立环境的现代服务器端的Java模板引擎，其主要目的是将优雅的Java模板带到开发工作流程中，将HTML在浏览器中显示，并且可以作为静态原型，让开发团队能更容易的协作。Thymeleaf能够处理HTML、XML、JavaScript、CSS甚至纯文本。</p>
</li>
<li><p><strong>Thymeleaf常用标签</strong></p>
<table>
<thead>
<tr>
<th>th:标签</th>
<th>说明</th>
<th>使用</th>
</tr>
</thead>
<tbody><tr>
<td>th:action</td>
<td>定义后台控制器路径，类似标签的action属性</td>
<td>&lt;form id=”login-form” th:action=”@{/login}”&gt;…&lt;/form&gt;</td>
</tr>
<tr>
<td>th:each</td>
<td>对象遍历，功能类似jstl中的&lt;c:forEach&gt;标签</td>
<td>&lt;tr th:each=”emp:${employees}”&gt;…&lt;/tr&gt;</td>
</tr>
<tr>
<td>th:href</td>
<td>定义超链接，类似标签的href 属性。value形式为@{/logout}</td>
<td>&lt;a th:href=”@{/logout}” class=”signOut”&gt;&lt;/a&gt;</td>
</tr>
<tr>
<td>th:if</td>
<td>条件判断</td>
<td>&lt;div th:if=”${rowStat.index} == 0”&gt;… 该div显示 …&lt;/div&gt;</td>
</tr>
<tr>
<td>th:src</td>
<td>用于外部资源引入，类似于</td>
<td>&lt;script th:src=”@{/resources/js/jquery/jquery.json-2.4.min.js}”</td>
</tr>
<tr>
<td>th:text</td>
<td>文本显示</td>
<td></td><td class="text" th:text="${username}"></td>
</tr>
<tr>
<td>th:value</td>
<td>用于标签复制，类似标签的value属性</td>
<td>&lt;input  id=”msg” type=”hidden” th:value=”${msg}” /&gt;</td>
</tr>
</tbody></table>
</li>
<li><p>声明定义该属性的div为模板片段，常用与头文件、页尾文件的引入。<strong>th:fragment</strong>常与<strong>th:include，th:replace</strong>一起使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- 声明模板片段footer. html --&gt; <br>&lt;nav th:fragment=<span class="hljs-string">&quot;sidebar&quot;</span>&gt;...&lt;/nav&gt;<br><br>&lt;!-- 引入模板片段 --&gt; <br>//插入片段，保留自身标记<br>&lt;div th:insert=<span class="hljs-string">&quot;~&#123;commons/commons::sidebar&#125;&quot;</span>&gt;&lt;/div&gt;<br>//插入片段的内容，去掉片段外层标记，同时保留自身标记<br>&lt;div th:include=<span class="hljs-string">&quot;~&#123;commons/commons::sidebar&#125;&quot;</span>&gt;&lt;/div&gt;<br>//插入片段，替换了自身标记<br>&lt;div th:replace=<span class="hljs-string">&quot;~&#123;commons/commons::sidebar(active=&#x27;main.html&#x27;)&#125;&quot;</span>&gt;&lt;/div&gt;<br><br>//对引入的模板进行判断来实现不同的样式展示<br>&lt;a th:class=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;active==&#x27;main.html&#x27;?&#x27;nav-link active&#x27;:&#x27;nav-link&#x27;&#125;</span>&quot;</span>&gt;...&lt;/a&gt;<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Thymeleaf主要标准表达式语法</strong></p>
<table>
<thead>
<tr>
<th>说明</th>
<th>表达式语法</th>
</tr>
</thead>
<tbody><tr>
<td>变量表达式</td>
<td>${…}</td>
</tr>
<tr>
<td>选择变量表达式</td>
<td>*{…}</td>
</tr>
<tr>
<td>消息表达式</td>
<td>#{…}</td>
</tr>
<tr>
<td>链接URL表达式</td>
<td>@{…}</td>
</tr>
<tr>
<td>片段表达式</td>
<td>~{…}</td>
</tr>
</tbody></table>
</li>
</ul>
<p>&nbsp;&nbsp;<strong>2.Thymeleaf基本配置</strong></p>
<blockquote>
<p>1.引入Thymeleaf依赖</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>2.全局配置文件中配置Thymeleaf一些基本参数</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">spring.thymeleaf.cache = <span class="hljs-literal">false</span> <span class="hljs-comment">#启用模板缓存</span><br>spring.thymeleaf.encoding = UTF-8 <span class="hljs-comment">#模板编码</span><br>spring.thymeleaf.mode = HTML5 <span class="hljs-comment">#应用于模板的模板模式</span><br>spring.thymeleaf.prefix = classpath:/resources/templates/ <span class="hljs-comment">#指定模板页面存放路径</span><br>spring.thymeleaf.suffix = .html <span class="hljs-comment">#指定模板页面名称的后缀</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>3.获取数据</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/findUsers&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findUsers</span><span class="hljs-params">(Model model)</span></span>&#123;<br>	List&lt;User&gt; user = userService.findUsers();<br>	model.addAttribute(<span class="hljs-string">&quot;user&quot;</span>,user);<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;user&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>4.编写页面<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!DOCTYPE html&gt;<br>&lt;html xmlns:th=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;首页&lt;/title&gt;<br>    &lt;style <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;<br>        table &#123;border-collapse: collapse; font-size: 14px; width: 80%; margin: auto&#125;<br>        table, th, td &#123;border: 1px solid darkslategray;padding: 10px&#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;div style=<span class="hljs-string">&quot;text-align: center&quot;</span>&gt;<br>    &lt;span style=<span class="hljs-string">&quot;color: darkslategray; font-size: 30px&quot;</span>&gt;欢迎光临！&lt;/span&gt;<br>    &lt;hr/&gt;<br>    &lt;table class=<span class="hljs-string">&quot;list&quot;</span>&gt;<br>        &lt;tr&gt;<br>            &lt;th&gt;id&lt;/th&gt;<br>            &lt;th&gt;姓名&lt;/th&gt;<br>            &lt;th&gt;用户名&lt;/th&gt;<br>            &lt;th&gt;年龄&lt;/th&gt;<br>            &lt;th&gt;性别&lt;/th&gt;<br>            &lt;th&gt;生日&lt;/th&gt;<br>        &lt;/tr&gt;<br>        &lt;tr th:each=<span class="hljs-string">&quot;u : <span class="hljs-variable">$&#123;user&#125;</span>&quot;</span>&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;u.id&#125;</span>&quot;</span>&gt;1&lt;/td&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;u.name&#125;</span>&quot;</span>&gt;张三&lt;/td&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;u.userName&#125;</span>&quot;</span>&gt;zhangsan&lt;/td&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;u.age&#125;</span>&quot;</span>&gt;20&lt;/td&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;u.sex&#125;</span> == 1 ? &#x27;男&#x27;: &#x27;女&#x27;&quot;</span>&gt;男&lt;/td&gt;<br>            &lt;td th:text=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#dates.format(u.birthday, &#x27;yyyy-MM-dd&#x27;)&#125;</span>&quot;</span>&gt;2020-02-12&lt;/td&gt;<br>        &lt;/tr&gt;<br>    &lt;/table&gt;<br>&lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="三-SpringBoot数据访问"><a href="#三-SpringBoot数据访问" class="headerlink" title="三.SpringBoot数据访问"></a>三.SpringBoot数据访问</h2><h3 id="3-0-xml整合Mybatis"><a href="#3-0-xml整合Mybatis" class="headerlink" title="3.0 xml整合Mybatis"></a>3.0 xml整合Mybatis</h3><p><strong>1.基础环境搭建</strong></p>
<blockquote>
<p>1.0 数据准备</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">DROP TABLE IF EXISTS `employee`;<br>CREATE TABLE `employee`  (<br>  `id` int(11) NOT NULL AUTO_INCREMENT,<br>  `lastName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,<br>  `email` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,<br>  `gender` int(1) NULL DEFAULT NULL,<br>  `birth` datetime NULL DEFAULT NULL,<br>  `did` int(11) NULL DEFAULT NULL,<br>  PRIMARY KEY (`id`) USING BTREE,<br>  INDEX `did`(`did`) USING BTREE,<br>  CONSTRAINT `did` FOREIGN KEY (`did`) REFERENCES `department` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT<br>) ENGINE = InnoDB AUTO_INCREMENT = 1006 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;<br><br>-- ----------------------------<br>-- Records of employee<br>-- ----------------------------<br>INSERT INTO `employee` VALUES (1001, <span class="hljs-string">&#x27;AA&#x27;</span>, <span class="hljs-string">&#x27;123531293@qq.com&#x27;</span>, 1, <span class="hljs-string">&#x27;2019-12-06 04:00:00&#x27;</span>, 102);<br>INSERT INTO `employee` VALUES (1002, <span class="hljs-string">&#x27;BB&#x27;</span>, <span class="hljs-string">&#x27;213531293@qq.com&#x27;</span>, 0, <span class="hljs-string">&#x27;2019-12-05 16:12:00&#x27;</span>, 103);<br>INSERT INTO `employee` VALUES (1003, <span class="hljs-string">&#x27;GG&#x27;</span>, <span class="hljs-string">&#x27;753531293@qq.com&#x27;</span>, 0, <span class="hljs-string">&#x27;2019-12-05 16:00:00&#x27;</span>, 103);<br>INSERT INTO `employee` VALUES (1004, <span class="hljs-string">&#x27;GG&#x27;</span>, <span class="hljs-string">&#x27;753531293@qq.com&#x27;</span>, 0, <span class="hljs-string">&#x27;2019-12-05 16:00:00&#x27;</span>, 104);<br>INSERT INTO `employee` VALUES (1005, <span class="hljs-string">&#x27;GG&#x27;</span>, <span class="hljs-string">&#x27;753531293@qq.com&#x27;</span>, 0, <span class="hljs-string">&#x27;2019-12-05 16:00:00&#x27;</span>, 105);<br><br>SET FOREIGN_KEY_CHECKS = 1;<br><br></code></pre></td></tr></table></figure>
<blockquote>
<p>1.1 根据数据库表编写相应的实体类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> </span>&#123;<br><br>     <span class="hljs-keyword">private</span> Integer id;<br>     <span class="hljs-keyword">private</span> String lastName;<br>     <span class="hljs-keyword">private</span> String email;<br>     <span class="hljs-keyword">private</span> Integer gender;<br>     <span class="hljs-keyword">private</span> Integer did;<br><br>     <span class="hljs-keyword">private</span> Department department;<br>     <span class="hljs-keyword">private</span> Date birth;<br><br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Employee</span><span class="hljs-params">(Integer id, String lastName, String email, Integer gender, Department department)</span> </span>&#123;<br>          <span class="hljs-keyword">this</span>.id = id;<br>          <span class="hljs-keyword">this</span>.lastName = lastName;<br>          <span class="hljs-keyword">this</span>.email = email;<br>          <span class="hljs-keyword">this</span>.gender = gender;<br>          <span class="hljs-keyword">this</span>.department = department;<br>          <span class="hljs-comment">//默认的创建日期</span><br>          <span class="hljs-keyword">this</span>.birth = <span class="hljs-keyword">new</span> Date();<br>     &#125;<br>	 <span class="hljs-comment">//此处省略setter、getter、toString法</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<blockquote>
<p>1.2 引入mybatis依赖和Druid数据源</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;dependency&gt;<br>	&lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;<br>	&lt;version&gt;2.1.1&lt;/version&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>	&lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>	&lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;<br>	&lt;version&gt;1.1.10&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>1.3 编写数据库驱动和Mybatis配置文件(我使用的是yaml)</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">spring:<br>  datasource:<br>    username: root<br>    password: root<br>    url: jdbc:mysql://localhost:3306/tests?serverTimezone=UTC&amp;characterEncoding=utf-8&amp;useUnicode=<span class="hljs-literal">true</span><br>    driver-class-name: com.mysql.cj.jdbc.Driver<br>	<span class="hljs-built_in">type</span>: com.alibaba.druid.pool.DruidDataSource <span class="hljs-comment">#配置第三方数据源</span><br>    filters: <span class="hljs-built_in">stat</span>,wall,log4j<br>mybatis:<br>  type-aliases-package: com.chu.pojo <span class="hljs-comment">#别名配置</span><br>  mapper-locations: classpath:mybatis/mapper/*.xml <span class="hljs-comment">#配置XML映射文件中指定的实体类别名路径</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>1.4 自定义Druid配置类对数据源属性值进行配置</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.config;<br><br><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSource;<br><span class="hljs-keyword">import</span> com.alibaba.druid.support.http.StatViewServlet;<br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.ServletRegistrationBean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DruidConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@ConfigurationProperties(&quot;spring.datasource&quot;)</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">druidDataSource</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DruidDataSource();<br>    &#125;<br><br>    <span class="hljs-comment">//后台监控</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ServletRegistrationBean <span class="hljs-title">statViewServlet</span><span class="hljs-params">()</span></span>&#123;<br>        ServletRegistrationBean&lt;StatViewServlet&gt; bean = <span class="hljs-keyword">new</span> ServletRegistrationBean&lt;&gt;(<span class="hljs-keyword">new</span> StatViewServlet(), <span class="hljs-string">&quot;/druid/*&quot;</span>);<br>        <span class="hljs-comment">//后台需要有人登录</span><br>        HashMap&lt;String,String&gt; initParameters = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        <span class="hljs-comment">//增加配置</span><br>        initParameters.put(<span class="hljs-string">&quot;loginUsername&quot;</span>,<span class="hljs-string">&quot;admin&quot;</span>); <span class="hljs-comment">//登录key是固定的</span><br>        initParameters.put(<span class="hljs-string">&quot;loginPassword&quot;</span>,<span class="hljs-string">&quot;123456&quot;</span>);<br>        bean.setInitParameters(initParameters);<span class="hljs-comment">//设置初始化参数</span><br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><strong>2.配置文件方式整合Mybatis</strong></p>
<blockquote>
<p>创建一个与数据库表对应的接口Mapper文件</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.chu.pojo.Employee;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-keyword">import</span> java.util.Collection;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmployeeDaoMapper</span> </span>&#123;<br>    <span class="hljs-comment">//查询所有员工</span><br>    <span class="hljs-function">Collection&lt;Employee&gt; <span class="hljs-title">getEmployeeAll</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>该Mapper接口文件声明了查询员工集合的一个方法</p>
<blockquote>
<p>编写EmployeeDaoMapper接口对应的映射文件EmployeeMapper.xml</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;<br>&lt;!DOCTYPE mapper<br>        PUBLIC <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br>        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;<br>&lt;mapper namespace=<span class="hljs-string">&quot;com.chu.mapper.EmployeeDao&quot;</span>&gt;<br>    &lt;resultMap id=<span class="hljs-string">&quot;employeeMap&quot;</span> type=<span class="hljs-string">&quot;Employee&quot;</span>&gt;<br>        &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;&lt;/id&gt;<br>        &lt;result property=&quot;lastName&quot; column=&quot;lastName&quot;&gt;&lt;/result&gt;<br>        &lt;result property=&quot;email&quot; column=&quot;email&quot;&gt;&lt;/result&gt;<br>        &lt;result property=&quot;gender&quot; column=&quot;gender&quot;&gt;&lt;/result&gt;<br>        &lt;result property=&quot;birth&quot; column=&quot;birth&quot;&gt;&lt;/result&gt;<br>        &lt;result property=&quot;did&quot; column=&quot;did&quot;&gt;&lt;/result&gt;<br><br>        &lt;association property=<span class="hljs-string">&quot;department&quot;</span> column=<span class="hljs-string">&quot;did&quot;</span> javaType=<span class="hljs-string">&quot;Department&quot;</span>&gt;<br>            &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;&lt;/id&gt;<br>            &lt;result property=&quot;departmentName&quot; column=&quot;departmentName&quot;&gt;&lt;/result&gt;<br>        &lt;/association&gt;<br>    &lt;/resultMap&gt;<br>&lt;/mapper&gt;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>编写单端测试进行接口方法测试</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu;<br><br><span class="hljs-keyword">import</span> com.chu.mapper.EmployeeDao;<br><span class="hljs-keyword">import</span> com.chu.pojo.Employee;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class="hljs-keyword">import</span> java.util.Collection;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApplicationTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmployeeDao employeeDao;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectEmployee</span><span class="hljs-params">()</span></span>&#123;<br>        Collection&lt;Employee&gt; employees = employeeDao.getEmployeeAll();<br>        System.out.println(employees);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><img src="https://img.wenhairu.com/images/2021/05/14/aBIYN.png" srcset="/img/loading.gif" lazyload alt="3.0"></p>
<h3 id="3-1-注解整合Mybatis"><a href="#3-1-注解整合Mybatis" class="headerlink" title="3.1 注解整合Mybatis"></a>3.1 注解整合Mybatis</h3><ul>
<li>1.导入实体类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Comment</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String content;<br>    <span class="hljs-keyword">private</span> String author;<br>    <span class="hljs-keyword">private</span> Integer aId;<br>	<br>	<span class="hljs-comment">//此处省略setter、getter、toString法</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>2.创建Mapper接口，并注入容器，实现注解实现增删改查<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.boot_test02.mapper;<br><br><span class="hljs-keyword">import</span> com.chu.boot_test02.domain.Comment;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.*;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CommentMapper</span> </span>&#123;<br><br>    <span class="hljs-meta">@Select(&quot;select * from t_comment where id = #&#123;id&#125;&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Comment <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span></span>;<br><br>   <span class="hljs-comment">/* @Insert(&quot;insert into t_comment(content,author,aId) values (#&#123;content,#&#123;author&#125;,#&#123;aId&#125;)&quot;)</span><br><span class="hljs-comment">    public  int insertComment(Comment comment);*/</span><br><br>    <span class="hljs-meta">@Update(&quot;update t_comment set content=#&#123;content&#125; where id=#&#123;id&#125;&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">updateComment</span><span class="hljs-params">(Comment comment)</span></span>;<br><br>    <span class="hljs-meta">@Delete(&quot;delete from t_comment where id = #&#123;id&#125;)</span><span class="hljs-string">&quot;)</span><br><span class="hljs-string">    public int deleteComment(Integer id);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure></li>
<li>3.编写测试类实现数据库数据的操作<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> com.chu.boot_test03.domain.*;<br><span class="hljs-keyword">import</span> com.chu.boot_test03.mapper.CommentMapper;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BootTest03ApplicationTests</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> CommentMapper commentMapper;<br>	<br>	<span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectComment</span><span class="hljs-params">()</span></span>&#123;<br>        Comment c = commentMapper.findById(<span class="hljs-number">1</span>);<br>        System.out.println(c);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<img src="https://img.wenhairu.com/images/2021/05/18/avb7u.png" srcset="/img/loading.gif" lazyload alt="3.1.0"></li>
<li><strong>注意：</strong>我们当前的aId属性并没有获取到值，由于驼峰的问题并没有映射到值，我们可以配置属性忽略驼峰问题(yaml写法)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">mybatis:<br>  configuration:<br>    map-underscore-to-camel-case: <span class="hljs-literal">true</span> <span class="hljs-comment">#开启驼峰命名规则匹配</span><br></code></pre></td></tr></table></figure>
<img src="https://img.wenhairu.com/images/2021/05/18/avdih.png" srcset="/img/loading.gif" lazyload alt="3.1.1"></li>
</ul>
<h3 id="3-2-SpringBoot整合JPA"><a href="#3-2-SpringBoot整合JPA" class="headerlink" title="3.2 SpringBoot整合JPA"></a>3.2 SpringBoot整合JPA</h3><ul>
<li><p>Spring Data JPA是Spring在ORM框架、JPA规范的基础上封装的一套JPA应用框架，它提供了增删改查等常用功能，使开发者可以用较少的代码实现数据操作，同时还易于扩展。</p>
</li>
<li><p>1.添加Spring Data Jpa依赖启动器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li>
<li><p>2.编写ORM实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.persistence.*;<br><span class="hljs-comment">//标注要与数据库做映射的实体类，默认情况下，数据表的名称就是首字母小写的类名</span><br><span class="hljs-meta">@Entity(name = &quot;t_comment&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Discuss</span> </span>&#123;<br>    <span class="hljs-comment">//标注在类属性或者getter方法上，表示某一个属性对应表中的主键</span><br>    <span class="hljs-meta">@Id</span><br>    <span class="hljs-comment">//与@Id注解标注在同一位置，用于表示属性对应主键生成的策略，可省略</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String content;<br>    <span class="hljs-keyword">private</span> String author;<br>    <span class="hljs-comment">//标注在属性上，当类属性与表字段名称不同是，能够配合name属性表示类属性对应的表字段名</span><br>    <span class="hljs-meta">@Column(name = &quot;a_id&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer aId;<br>	<br>	<span class="hljs-comment">//...此处省略setter、getter、toString法</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>3.编写Repository接口，根据需要编写对应的数据操作方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.boot_test03.Pepository;<br><br><span class="hljs-keyword">import</span> com.chu.boot_test03.domain.Discuss;<br><span class="hljs-keyword">import</span> org.springframework.data.domain.Pageable;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.Modifying;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.Query;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DiscussRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">Discuss</span>,<span class="hljs-title">Integer</span>&gt; </span>&#123;<br>    <span class="hljs-comment">//1.查询author非空的Discuss评论集合</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Discuss&gt; <span class="hljs-title">findByAuthorNotNull</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">//2.根据文章id分页查询Discuss评论集合</span><br>    <span class="hljs-meta">@Query(&quot;select c from t_comment c where c.aId = ?1&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Discuss&gt; <span class="hljs-title">getDiscussPaged</span><span class="hljs-params">(Integer aid, Pageable pageable)</span></span>;<br><br>    <span class="hljs-comment">//3.使用元素SQL语句，根据文章id分页查询Discuss评论集合</span><br>    <span class="hljs-meta">@Query(value = &quot;select * from t_comment  where a_Id = ?1&quot;,nativeQuery = true)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Discuss&gt; <span class="hljs-title">getDiscussPaged2</span><span class="hljs-params">(Integer aid, Pageable pageable)</span></span>;<br><br>    <span class="hljs-comment">//表示支持事务管理</span><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-comment">//表示支持事务变更</span><br>    <span class="hljs-meta">@Modifying</span><br>    <span class="hljs-comment">//根据评论id修改评论作者author</span><br>    <span class="hljs-meta">@Query(&quot;update t_comment c set c.author  = ?1 where c.id = ?2&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">updateDiscuss</span><span class="hljs-params">(String author,Integer id)</span></span>;<br><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-meta">@Modifying</span><br>    <span class="hljs-comment">//根据评论id删除评论</span><br>    <span class="hljs-meta">@Query(&quot;DELETE t_comment c where c.id = ?1&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteDiscuss</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>4.编写单元测试进行接口方法测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><span class="hljs-keyword">import</span> java.util.Optional;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BootTest03ApplicationTests</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> DiscussRepository repository;<br>	<span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectCommentPaged</span><span class="hljs-params">()</span></span>&#123;<br>        Pageable of = PageRequest.of(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>);<br>        List&lt;Discuss&gt; discussPaged = repository.getDiscussPaged(<span class="hljs-number">1</span>, of);<br>        System.out.println(discussPaged);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="四-SpringBoot安全管理"><a href="#四-SpringBoot安全管理" class="headerlink" title="四.SpringBoot安全管理"></a>四.SpringBoot安全管理</h2><ul>
<li>在 Web 应用开发中，安全一直是非常重要的一个方面。安全虽然属于应用的非功能性需求，但是应该在应用开发的初期就考虑进来。本章详细介绍了如何使用 <strong>Spring Security</strong>和<strong>Shiro</strong> 来保护 Web 应用的安全。Spring Security 本身以及 Spring 框架带来的灵活性，能够满足一般 Web 应用开发的典型需求，并允许开发人员进行定制。下面首先简单介绍 Spring Security。</li>
</ul>
<h3 id="4-0-Security基本使用"><a href="#4-0-Security基本使用" class="headerlink" title="4.0 Security基本使用"></a>4.0 Security基本使用</h3><h4 id="4-0-0-Security基础环境搭建"><a href="#4-0-0-Security基础环境搭建" class="headerlink" title="4.0.0 Security基础环境搭建"></a>4.0.0 Security基础环境搭建</h4><ul>
<li><strong>Spring Security</strong>的安全管理有两个重要概念，分别是<strong>Authentication(认证)<strong>和</strong>Authorization(授权)<strong>。其中，</strong>认证</strong>即确认用户是否登录，并对用户登录进行管控；<strong>授权</strong>即确定用户所拥有的功能权限，并对用户权限进行管控。</li>
<li>首先创建spring boot项目HelloSecurity<blockquote>
<p>1).引入pom依赖</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- security --&gt;<br>&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br><br>&lt;!-- thymeleaf-springSecurity整合 --&gt;<br>&lt;dependency&gt;<br>	&lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;<br>	&lt;artifactId&gt;thymeleaf-extras-springsecurity5&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>2).然后在src/main/resources/templates/目录下创建页面：index.html文件是项目首页</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">  &lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span> xmlns:th=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=<span class="hljs-string">&quot;center&quot;</span>&gt;欢迎进入电影网站首页&lt;/h1&gt;<br>&lt;hr&gt;<br>   &lt;h3&gt;普通电影&lt;/h3&gt;<br>   &lt;ul&gt;<br>       &lt;li&gt;&lt;a th:href=<span class="hljs-string">&quot;@&#123;/detail/common/1&#125;&quot;</span>&gt;飞驰人生&lt;/a&gt;&lt;/li&gt;<br>       &lt;li&gt;&lt;a th:href=<span class="hljs-string">&quot;@&#123;/detail/common/2&#125;&quot;</span>&gt;夏洛特烦恼&lt;/a&gt;&lt;/li&gt;<br>   &lt;/ul&gt;<br><br>    &lt;h3&gt;VIP专享&lt;/h3&gt;<br>    &lt;ul&gt;<br>        &lt;li&gt;&lt;a th:href=<span class="hljs-string">&quot;@&#123;/detail/vip/1&#125;&quot;</span>&gt;速度与激情&lt;/a&gt;&lt;/li&gt;<br>        &lt;li&gt;&lt;a th:href=<span class="hljs-string">&quot;@&#123;/detail/vip/2&#125;&quot;</span>&gt;猩球崛起&lt;/a&gt;&lt;/li&gt;<br>    &lt;/ul&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<img src="https://img.wenhairu.com/images/2021/05/16/abslD.md.png" srcset="/img/loading.gif" lazyload alt="4.0.0"><br>common和vip文件夹中分别对应的是普通用户和vip用户可访问的页面，index.html首页中通过标签展示了一些普通电影和vip电影，并通过&lt;a&gt;标签链接到了具体影片详情<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span> xmlns:th=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;影片详情&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>   &lt;a th:href=<span class="hljs-string">&quot;@&#123;/&#125;&quot;</span>&gt;返回&lt;/a&gt;<br>   &lt;h2&gt;飞驰人生&lt;/h2&gt;<br>   &lt;p&gt;<br>       飞驰人生介绍...<br>   &lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<img src="https://img.wenhairu.com/images/2021/05/16/ab3Et.png" srcset="/img/loading.gif" lazyload alt="4.0.1"></li>
<li><strong>注意：</strong>引入security的pom依赖后，通过浏览器访问localhost:8080会自动跳到一个新的登录链接页面，说明项目在添加Security依赖时实现了自动化配置，并且拥有了一些默认的安全管理功能。当在SpringSecurity提供的默认登录页面”/login”中输入错误登录信息后，会重定向到”/login?error”页面并显示出错误信息。</li>
</ul>
<h4 id="4-0-1-Security安全配置"><a href="#4-0-1-Security安全配置" class="headerlink" title="4.0.1 Security安全配置"></a>4.0.1 Security安全配置</h4><ul>
<li>1.自定义WebSecurityConfigurerAdapter配置类并使用内存进行身份认证<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><br><span class="hljs-meta">@EnableWebSecurity</span> <span class="hljs-comment">//开启安全支持</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">//密码需要设置编码器</span><br>        BCryptPasswordEncoder encoder = <span class="hljs-keyword">new</span> BCryptPasswordEncoder();<br>        <span class="hljs-comment">//使用内存用户信息，作为测试使用</span><br>        auth.inMemoryAuthentication().passwordEncoder(encoder)<br>                .withUser(<span class="hljs-string">&quot;chu&quot;</span>).password(encoder.encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;common&quot;</span>)<br>                .and()<br>                .withUser(<span class="hljs-string">&quot;里斯&quot;</span>).password(encoder.encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>2.效果测试，启动项目，通过浏览器访问”<a target="_blank" rel="noopener" href="http://localhost:8080/&quot;%E6%9F%A5%E7%9C%8B%E9%A6%96%E9%A1%B5">http://localhost:8080/&quot;查看首页</a><br><img src="https://img.wenhairu.com/images/2021/05/17/at2nX.png" srcset="/img/loading.gif" lazyload alt="4.1.0"></li>
</ul>
<h4 id="4-0-2-JDBC身份认证"><a href="#4-0-2-JDBC身份认证" class="headerlink" title="4.0.2 JDBC身份认证"></a>4.0.2 JDBC身份认证</h4><ul>
<li><p>我们可以使用数据库中已有的用户信息在项目中实现用户功能</p>
</li>
<li><p>1.数据准备</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">DROP TABLE IF EXISTS `t_authority`;<br>CREATE TABLE `t_authority`  (<br>  `id` int(20) NOT NULL AUTO_INCREMENT,<br>  `authority` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,<br>  PRIMARY KEY (`id`) USING BTREE<br>) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;<br><br>-- ----------------------------<br>-- Records of t_authority<br>-- ----------------------------<br>INSERT INTO `t_authority` VALUES (1, <span class="hljs-string">&#x27;ROLE_common&#x27;</span>);<br>INSERT INTO `t_authority` VALUES (2, <span class="hljs-string">&#x27;ROLE_vip&#x27;</span>);<br><br>SET FOREIGN_KEY_CHECKS = 1;<br><br>DROP TABLE IF EXISTS `t_customer`;<br>CREATE TABLE `t_customer`  (<br>  `id` int(11) NOT NULL,<br>  `username` varchar(200) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,<br>  `password` varchar(200) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,<br>  `valid` tinyint(1) NULL DEFAULT 1,<br>  PRIMARY KEY (`id`) USING BTREE<br>) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;<br><br>-- ----------------------------<br>-- Records of t_customer<br>-- ----------------------------<br>INSERT INTO `t_customer` VALUES (1, <span class="hljs-string">&#x27;shitou&#x27;</span>, <span class="hljs-string">&#x27;$2a$10$5ooQI8dir8jv0/gCa1Six.GpzAdIPf6pMqdminZ/3ijYzivCyP1fK&#x27;</span>, 1);<br>INSERT INTO `t_customer` VALUES (2, <span class="hljs-string">&#x27;李四&#x27;</span>, <span class="hljs-string">&#x27;$10$5ooQI8dir8jv0/gCa1Six.GpzAdIPf6pMqdminZ/3ijYzivCyP1fK&#x27;</span>, 1);<br><br>SET FOREIGN_KEY_CHECKS = 1;<br><br>DROP TABLE IF EXISTS `t_customer_authority`;<br>CREATE TABLE `t_customer_authority`  (<br>  `id` int(20) NOT NULL,<br>  `customer_id` int(20) NULL DEFAULT NULL,<br>  `authority_id` int(20) NULL DEFAULT NULL,<br>  PRIMARY KEY (`id`) USING BTREE<br>) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;<br><br>-- ----------------------------<br>-- Records of t_customer_authority<br>-- ----------------------------<br>INSERT INTO `t_customer_authority` VALUES (1, 1, 1);<br>INSERT INTO `t_customer_authority` VALUES (2, 2, 2);<br><br>SET FOREIGN_KEY_CHECKS = 1;<br></code></pre></td></tr></table></figure></li>
<li><p>2.添加JDBC依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br><br>&lt;dependency&gt;<br>	&lt;groupId&gt;mysql&lt;/groupId&gt;<br>	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;<br>	&lt;scope&gt;runtime&lt;/scope&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li>
<li><p>3.配置数据库连接(application.properties)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">spring.datasource.username=root<br>spring.datasource.password=root<br>spring.datasource.url=jdbc:mysql://localhost:3306/<span class="hljs-built_in">test</span>?serverTimezone=UTC&amp;characterEncoding=utf-8&amp;useUnicode=<span class="hljs-literal">true</span><br>spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver<br></code></pre></td></tr></table></figure></li>
<li><p>4.使用JDBC进行认证<br>使用JDBC身份认证时，首先需要对密码编码设置(必须与数据库中用户密码加密方式一致),然后需要加载JDBC进行认证连接的数据源DataSource,最后，执行SQL语句，实现通过用户名username查询用户信息和用户权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.boot_security.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><br><span class="hljs-meta">@EnableWebSecurity</span> <span class="hljs-comment">//开启安全支持</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br>    <span class="hljs-comment">//装配数据源</span><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> DataSource dataSource;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">//密码需要设置编码器</span><br>        BCryptPasswordEncoder encoder = <span class="hljs-keyword">new</span> BCryptPasswordEncoder();<br>        <span class="hljs-comment">//使用jdbc进行认证</span><br>        String userSQL = <span class="hljs-string">&quot;select username,password,valid from t_customer where username = ?&quot;</span>;<br>        String authoritySQL = <span class="hljs-string">&quot;select c.username,a.authority from t_customer c,&quot;</span> +<br>                <span class="hljs-string">&quot;t_authority a,t_customer_authority ca where ca.customer_id = c.id and ca.authority_id = a.id and c.username = ?&quot;</span>;<br>        <span class="hljs-comment">//使用内存用户信息，作为测试使用</span><br>       <span class="hljs-comment">/* auth.inMemoryAuthentication().passwordEncoder(encoder)</span><br><span class="hljs-comment">                .withUser(&quot;chu&quot;).password(encoder.encode(&quot;123456&quot;)).roles(&quot;common&quot;)</span><br><span class="hljs-comment">                .and()</span><br><span class="hljs-comment">                .withUser(&quot;里斯&quot;).password(encoder.encode(&quot;123456&quot;)).roles(&quot;vip&quot;);*/</span><br>        <span class="hljs-comment">//使用JDBC身份认证时，首先需要对密码编码设置(必须与数据库中用户密码加密方式一致),然后需要加载JDBC进行认证连接的数据源DataSource,最后，执行SQL语句，实现通过用户名username查询用户信息和用户权限</span><br>        auth.jdbcAuthentication().passwordEncoder(encoder)<br>                .dataSource(dataSource)<br>                .usersByUsernameQuery(userSQL)<br>                .authoritiesByUsernameQuery(authoritySQL);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-0-3-自定义用户授权管理"><a href="#4-0-3-自定义用户授权管理" class="headerlink" title="4.0.3 自定义用户授权管理"></a>4.0.3 自定义用户授权管理</h4><ul>
<li>1.自定义用户访问控制<br>在创建的自定义配置类SecurityConfig重写configure方法进行用户访问控制。示例如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>	http.authorizeRequests()<br>			.antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll() <span class="hljs-comment">// &quot;/&quot;直接放行</span><br>			.antMatchers(<span class="hljs-string">&quot;/detail/common/**&quot;</span>).hasRole(<span class="hljs-string">&quot;common&quot;</span>) <span class="hljs-comment">//用户角色为common(ROLE_common)权限才允许访问</span><br>			.antMatchers(<span class="hljs-string">&quot;/detail/vip/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip&quot;</span>) <span class="hljs-comment">//用户角色为vip(ROLE_vip)权限才允许访问</span><br>			.anyRequest().authenticated()<span class="hljs-comment">//需要要求用户必须先进行登录认证</span><br>			.and()<br>			.formLogin();<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>2.效果测试<blockquote>
<p>直接访问时进入首页，这是因为自定义的用户访问控制中，对”/“的请求是直接放行的。<br><img src="https://img.wenhairu.com/images/2021/05/19/uFS1A.png" srcset="/img/loading.gif" lazyload alt="4.3.0"><br>访问首页影片详情时会直接被自定义的访问控制跳转到默认的登录页面。输入信息后会立即跳转到之前将要访问的页面详情页<br><img src="https://img.wenhairu.com/images/2021/05/17/at2nX.png" srcset="/img/loading.gif" lazyload alt="4.3.1"><br><img src="https://img.wenhairu.com/images/2021/05/19/uFc4T.png" srcset="/img/loading.gif" lazyload alt="4.3.2"></p>
</blockquote>
</li>
</ul>
<h4 id="4-0-4-自定义用户登录"><a href="#4-0-4-自定义用户登录" class="headerlink" title="4.0.4 自定义用户登录"></a>4.0.4 自定义用户登录</h4><ul>
<li>1.自定义用户登录页面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>用户登录页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/css/bootstrap.min.css&#125;&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/css/signin.css&#125;&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-center&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-signin&quot;</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;@&#123;/userLogin&#125;&quot;</span> <span class="hljs-attr">th:method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mb-4&quot;</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/img/123.png&#125;&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100px&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100px&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;h3 mb-3 font-weight-normal&quot;</span>&gt;</span>请登录<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- 用户登录错误信息提示框 --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:if</span>=<span class="hljs-string">&quot;$&#123;param.error&#125;&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red;height: 40px;text-align: left;font-size: 1.1em&quot;</span>&gt;</span><br>           用户名或密码错误<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">autofocus</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pwd&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">autofocus</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-lg btn-primary btn-block&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mt-5 mb-3 text-muted&quot;</span>&gt;</span>Copyright@ 2019-2021<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li>2.自定义用户登录跳转<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/userLogin&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toLoginPage</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;user/login&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>3.自定义用户登录控制<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>	http.authorizeRequests()<br>			.antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll() <span class="hljs-comment">// &quot;/&quot;直接放行</span><br>			<span class="hljs-comment">//需要对static文件夹下静态资源进行统一放行</span><br>			.antMatchers(<span class="hljs-string">&quot;/css/**&quot;</span>).permitAll()<br>			.antMatchers(<span class="hljs-string">&quot;/img/**&quot;</span>).permitAll()<br>			.antMatchers(<span class="hljs-string">&quot;/detail/common/**&quot;</span>).hasRole(<span class="hljs-string">&quot;common&quot;</span>) <span class="hljs-comment">//用户角色为common(ROLE_common)权限才允许访问</span><br>			.antMatchers(<span class="hljs-string">&quot;/detail/vip/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip&quot;</span>) <span class="hljs-comment">//用户角色为vip(ROLE_vip)权限才允许访问</span><br>			.anyRequest().authenticated();<span class="hljs-comment">//需要要求用户必须先进行登录认证</span><br>	<span class="hljs-comment">//自定义用户登录控制</span><br>	http.formLogin()<br>			<span class="hljs-comment">//像自定义登录页跳转的请求路径，并使用permitAll对登录跳转的请求进行放行</span><br>			.loginPage(<span class="hljs-string">&quot;/userLogin&quot;</span>).permitAll()<br>			<span class="hljs-comment">//接收登录时提交的用户名和密码</span><br>			.usernameParameter(<span class="hljs-string">&quot;name&quot;</span>).passwordParameter(<span class="hljs-string">&quot;pwd&quot;</span>)<br>			<span class="hljs-comment">//指定了用户登录成功后默认跳转到项目首页</span><br>			.defaultSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>)<br>			<span class="hljs-comment">//用来控制用户登录认证失败后的跳转路径，该方法默认的参数为&quot;/login?error&quot;</span><br>			.failureUrl(<span class="hljs-string">&quot;/userLogin?error&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>4.效果测试<br>启动项目进入首页后点击影片详情时，会跳转到我们自定义的用户登录界面，输入错误时会提示。输入正确后跳转到当前访问的页面<br><img src="https://img.wenhairu.com/images/2021/05/20/uJblu.png" srcset="/img/loading.gif" lazyload alt="4.4.0"></li>
</ul>
<h4 id="4-0-5-自定义用户退出"><a href="#4-0-5-自定义用户退出" class="headerlink" title="4.0.5 自定义用户退出"></a>4.0.5 自定义用户退出</h4><ul>
<li>1.添加自定义用户退出链接<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要实现自定义用户退出功能，必须先在某个页面定义用户退出链接或者按钮。我们可以在项目首页index.html新增一个用户退出连接。<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;@&#123;/mylogout&#125;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;注销&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>
新增一个&lg;from&gt;标签进行注销控制</li>
<li>2.自定义用户退出控制<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在SecurityConfig配置类的configure方法中进行用户退出控制。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//自定义用户退出控制</span><br>http.logout()<br>		<span class="hljs-comment">//指定用户退出请求路径</span><br>		.logoutUrl(<span class="hljs-string">&quot;/mylogout&quot;</span>)<br>		<span class="hljs-comment">//指定用户退出成功后重定向到&quot;/&quot;地址</span><br>		.logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<br></code></pre></td></tr></table></figure></li>
<li>3.效果测试<br><img src="https://img.wenhairu.com/images/2021/05/20/uJiEh.png" srcset="/img/loading.gif" lazyload alt="4.5.0"></li>
</ul>
<h4 id="4-0-6-记住我功能"><a href="#4-0-6-记住我功能" class="headerlink" title="4.0.6 记住我功能"></a>4.0.6 记住我功能</h4><ul>
<li><p>Spring Security针对记住我功能提供了两种实现：一种是<strong>简单的使用加密来保证基于 Cookie 中 Token 的安全</strong>；另一种是<strong>通过数据库或其它持久化机制来保存生成的Tocken</strong>。</p>
</li>
<li><p><font color="orange">1.基于简单加密 Token 的方式</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;基于简单加密Token的方式实现记住我功能非常简单，当用户选择记住我并登录成功后，Security会生成一个Cookie并发给客户端浏览器。基于简单加密Token的方式中Token在指定的时间内有效，且必须保证Tocken中所包含的username、password和key没有被改变。需要注意的是，这种方式是存在安全隐患的。<br>在login.html中新增一个记住我功能勾选框。示例代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;checkbox mb-3&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>	   <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;rememberme&quot;</span>&gt;</span>记住我<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>打开SecurityConfig配置类的configure方法中进行记住我配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//定制Remember-me记住我功能</span><br>http.rememberMe()<br>		<span class="hljs-comment">//指定了记住我勾选框的 name 指属性，如果页面中使用了默认的 &quot;remember-me&quot;,则该方法可以省略</span><br>		.rememberMeParameter(<span class="hljs-string">&quot;rememberme&quot;</span>)<br>		<span class="hljs-comment">//设置了记住我功能中Token的有效期为200s</span><br>		.tokenValiditySeconds(<span class="hljs-number">200</span>);<br></code></pre></td></tr></table></figure>
<p>在初次登录时勾选了【记住我】选项后，在设置的Token有效期内再次进行访问不需要重新登录认证。如果Token失效后，再次访问项目，则需要重新登录认证。</p>
</li>
<li><p><font color="orange">2.基于持久化Token的方式</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了对持久化Token进行存储，需要在数据库中创建一个存储Cookie信息的持续登录用户表persistent_logins，具体建表语句如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">create table persistent_logins (username varchar(64) not null,<br>                                series varchar(64) primary key,<br>								token varchar(64) not null,<br>								last_used timestamp not null);<br></code></pre></td></tr></table></figure>
<p>在完成存储Cookie信息的用户表创建以及页面记住我功能勾选框设置后，打开SecurityConfig类，重写configure方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">http.rememberMe()<br>	<span class="hljs-comment">//指定了记住我勾选框的 name 指属性，如果页面中使用了默认的 &quot;remember-me&quot;,则该方法可以省略</span><br>	.rememberMeParameter(<span class="hljs-string">&quot;rememberme&quot;</span>)<br>	<span class="hljs-comment">//设置了记住我功能中Token的有效期为200s</span><br>	.tokenValiditySeconds(<span class="hljs-number">200</span>)<br>	<span class="hljs-comment">//对Cookie信息进行持久化管理</span><br>	.tokenRepository(tokenRepository());<br></code></pre></td></tr></table></figure>
<p>实现tokenRepository()方法对    Cookie信息进行持久化管理。其中的tokenRepository()参数会返回一个设置dataSource数据源的JdbcTokenRepositoryImpl对象，该对象包含操作Token的各种方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//持久化Token存储</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> JdbcTokenRepositoryImpl <span class="hljs-title">tokenRepository</span><span class="hljs-params">()</span></span>&#123;<br>	JdbcTokenRepositoryImpl jr = <span class="hljs-keyword">new</span> JdbcTokenRepositoryImpl();<br>	jr.setDataSource(dataSource);<br>	<span class="hljs-keyword">return</span> jr;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;启动项目，通过浏览器访问项目登录页，在登录界面输入正确用户信息并勾选记住我后，此时数据库持久化数据表persistent_logins，包括用户名、序列号、Token和最近登录时间。登录用户手动实现用户退出时，数据库中的持久化用户信息也会随之删除。如果用户是在Token有效期后自动退出的，那么数据库中的persistent_logins表的持久化用户信息不会随之删除，当用户再次登录访问时，则是在表中新增一条持久化用户信息。</p>
</li>
</ul>
<h4 id="4-0-7-CSRF防护功能"><a href="#4-0-7-CSRF防护功能" class="headerlink" title="4.0.7 CSRF防护功能"></a>4.0.7 CSRF防护功能</h4><ul>
<li><p>一、CSRF是什么<br>CSRF全称为跨站请求伪造（Cross-site request forgery），是一种网络攻击方式，也被称为 one-click attack 或者 session riding。</p>
</li>
<li><p>二、CSRF攻击原理<br>CSRF攻击利用网站对于用户网页浏览器的信任，挟持用户当前已登陆的Web应用程序，去执行并非用户本意的操作。</p>
</li>
<li><p>三、在业界目前防御CSRF攻击主要有以下3种策略</p>
<blockquote>
<p>1).验证HTTP Referer字段<br>2).在请求地址中添加Token并验证<br>3).在HTTP头中自定义属性并验证</p>
</blockquote>
</li>
<li><p><font color="red">1.CSRFF防护功能关闭</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SpringBoot整合SpringSecurity默认开启了CSRF功能，并要求数据修改的请求方法(例如：PATCH、POST、PUT、DELETE)都需要经过Security配置的安全认证后方可正常访问，否则无法正常发送请求。</p>
<blockquote>
<p>1.创建数据修改页面。打开项目resources/templates目录，在该目录下创建一个名为csrf的文件夹，在该文件夹中模拟修改用户账户信息的csrfTest.html页面</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html">  <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/html&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>用户修改<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/updateUser&quot;</span>&gt;</span><br>        用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        密<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span>码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>2.在controller包下创建一个用于CSRF页面请求测试的控制类CERFController</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.chu.boot_security.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CERFController</span> </span>&#123;<br>    <br>    <span class="hljs-comment">//向用户修改页面跳转</span><br>    <span class="hljs-meta">@GetMapping(&quot;/toUpdate&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toUpdate</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;csrf/csrfTest&quot;</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">//用户修改提交处理</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-meta">@PostMapping(value = &quot;/updateUser&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">updateUser</span><span class="hljs-params">(String username, String password, HttpServletRequest request)</span></span>&#123;<br>        System.out.println(username);<br>        System.out.println(password);<br>        String csrf_token = request.getParameter(<span class="hljs-string">&quot;_csrf&quot;</span>);<br>        System.out.println(csrf_token);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>效果测试<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在所示的用户修改页面中，随意输入修改后的信息，点击【修改】按钮进行数据提交<br><img src="https://img.wenhairu.com/images/2021/05/20/uWcWo.png" srcset="/img/loading.gif" lazyload alt="4.0.7"><br><img src="https://img.wenhairu.com/images/2021/05/20/uWgSf.png" srcset="/img/loading.gif" lazyload alt="4.0.8"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从上图可以看出，在业务代码没有错误的情况下，表单中正确提交POST的请求数据被拦截，这说明在整合Security安全框架后，项目默认启用了CSRF安全防护功能，项目中所有涉及数据修改方式的请求都会被拦截。针对这种情况，可以有两种处理方式：<strong>一种方式是直接关闭Security默认开启的CSRF防御功能；另一种方式配置Security需要的CSRF Token</strong></p>
<blockquote>
<p>3.关闭默认开启的CSRF防御功能的话，打开配置类SecurityConfig，再重写configure方法中进行关闭配置即可</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//可以关闭SpringSecurity默认开启的CSRF防护功能</span><br>http.csrf().disable();<br></code></pre></td></tr></table></figure></li>
<li><p><font color="red">2.针对Form表单数据修改的CERF Token配置</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;针对Form表单类型的数据修改请求，Security支持在Form表单中提供一个携带 CSRF Token 信息的隐藏域，与其他修改数据一起提交，这样后台就可以获取并验证请求是否为安全的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/html&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>用户修改<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/updateUser&quot;</span>&gt;</span><br>	    <span class="hljs-comment">&lt;!-- th:name=&quot;$&#123;_csrf.parameterName&#125;&quot;会获取Security提供默认的CSRF Token对应的key值_csrf</span><br><span class="hljs-comment">             th:value=&quot;$&#123;_csrf.token&#125;&quot;会获取Security默认随机生成的CSRF Token对应的value值</span><br><span class="hljs-comment">		--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">th:name</span>=<span class="hljs-string">&quot;$&#123;_csrf.parameterName&#125;&quot;</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;$&#123;_csrf.token&#125;&quot;</span>&gt;</span><br>        用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        密<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span>码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上述代码中，Form表单中&lg;input&gt;隐藏标签携带了Security提供的CSRF Tocken信息。在Form表单中添加上述CSRF Token配置后，无需其他配置就可以正常实现数据修改请求，后台配置的Security会自动获取并识别请求中的CSRF Token信息并进行用户信息验证，从而判断是否安全。<br><font color="orange">还可以使用Thymeleaf模板的th:action属性配置CSRF Token信息</font></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;/updateUser&quot;</span>&gt;</span><br>	用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>	密<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span>码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thymeleaf模板的th:action属性配置请求时，会默认携带CERF Token信息，无需了开发者手动添加。</p>
</li>
<li><p><font color="red">3.针对Ajax数据修改请求的CSRF Token配置</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对于Ajax类型的数据修改请求来说，Security提供了通过添加HTTP header头信息的方式携带CSRF Token 信息进行请求验证。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先，在页面&lt;head&gt;标签中添加&amp;ltmeta&gt;子标签，并配置CSRF Token 信息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 获取CSRF Token --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;_csrf&quot;</span> <span class="hljs-attr">th:content</span>=<span class="hljs-string">&quot;$&#123;_csrf.token&#125;&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 获取CSRF头，默认为X-CSRF-TOKEN --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;_csrf_header&quot;</span> <span class="hljs-attr">th:content</span>=<span class="hljs-string">&quot;$&#123;_csrf.headerName&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>用户修改<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-0-8-Security管理前端页面"><a href="#4-0-8-Security管理前端页面" class="headerlink" title="4.0.8 Security管理前端页面"></a>4.0.8 Security管理前端页面</h4><ul>
<li><p>1.导入Thymeleaf和Security整合依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- thymeleaf-springSecurity整合 --&gt;<br>&lt;dependency&gt;<br>	&lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;<br>	&lt;artifactId&gt;thymeleaf-extras-springsecurity5&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure></li>
<li><p>2.修改前端页面，使用Security相关标签进行页面控制<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打开首页index.html，引入Security安全标签，并在页面中根据使用Security标签进行显示控制</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:sec</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity4&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>欢迎进入电影网站首页<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 判断用户是否未登录 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;isAnonymous()&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>游客你好，如果想查看电影<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/userLogin&#125;&quot;</span>&gt;</span>请登录<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 判断用户是否已登录 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;isAuthenticated()&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 显示当前用户名字 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">sec:authentication</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: #007bff&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 显示用户权限 --&gt;</span><br>    您好，你的用户权限为<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">sec:authentication</span>=<span class="hljs-string">&quot;principal.authorities&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: darkkhaki&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    ，你有权看以下电影<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;@&#123;/mylogout&#125;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;注销&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 定义了只有角色为common(对应权限Authority为ROLE_common)且登录的用户才会显示普通电影列表 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;hasRole(&#x27;common&#x27;)&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>普通电影<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/detail/common/1&#125;&quot;</span>&gt;</span>飞驰人生<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/detail/common/2&#125;&quot;</span>&gt;</span>夏洛特烦恼<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 定义了只有角色为ROLE_vip(对应角色Role为vip)且登录的用户才会显示vip电影列表 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;hasAnyAuthority(&#x27;ROLE_vip&#x27;)&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>VIP专享<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/detail/vip/1&#125;&quot;</span>&gt;</span>速度与激情<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/detail/vip/2&#125;&quot;</span>&gt;</span>猩球崛起<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://img.wenhairu.com/images/2021/05/20/uW0Hq.png" srcset="/img/loading.gif" lazyload alt="4.0.8.0"><br><img src="https://img.wenhairu.com/images/2021/05/20/uW4XX.png" srcset="/img/loading.gif" lazyload alt="4.0.8.1"></p>
</li>
<li><p>表达式描述</p>
<blockquote>
<p><font color="red">hasRole([role])</font> 用户拥有制定的角色时返回true （Spring security默认会带有ROLE_前缀）<br><font color="red">hasAnyRole([role1,role2])</font> 用户拥有任意一个制定的角色时返回true<br><font color="red">hasAuthority([authority])</font> 等同于hasRole,但不会带有ROLE_前缀<br><font color="red">hasAnyAuthority([auth1,auth2])</font> 等同于hasAnyRole<br><font color="red">permitAll</font> 永远返回true<br><font color="red">denyAll</font> 永远返回false<br><font color="red">rememberMe</font> 当前勇士是rememberMe用户返回true<br><font color="red">authentication</font> 当前登录用户的authentication对象<br><font color="red">fullAuthenticated</font> 当前用户既不是anonymous也不是rememberMe用户时返回true</p>
</blockquote>
</li>
</ul>
<h2 id="五-SpringBoot任务管理"><a href="#五-SpringBoot任务管理" class="headerlink" title="五.SpringBoot任务管理"></a>五.SpringBoot任务管理</h2>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/springboot/">springboot</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/springboot/">springboot</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客均为ever个人编写,请勿私自转载！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/05/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">设计模式</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/05/01/vue/">
                        <span class="hidden-mobile">Vue</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function () {
        new Valine({
          el: "#valine",
          app_id: "7FMK2vmAfJ5cmi4Xka5iLGb2-gzGzoHsz",
          app_key: "NtIASB22WiwVXkBn1dj3H0jM",
          placeholder: "说点什么",
          path: window.location.pathname,
          avatar: "retro",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: false,
          recordIP: false,
          serverURLs: "",
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
   
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
	<!--《添加网站运行时间 -->
<br/>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
var now = new Date(); 

function createtime() {
    //此处修改你的建站时间或者网站上线时间
    var grt = new Date('03/18/2021 8:00:00');
    now.setTime(now.getTime() + 250);
    days = (now - grt) / 1000 / 60 / 60 / 24;

    dnum = Math.floor(days);
    hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
        hnum = "0" + hnum;
    }
    minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
        mnum = "0" + mnum;
    }
    seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
        snum = "0" + snum;
    }
    document.getElementById("timeDate").innerHTML = " 本站已各种夹缝中安全运行 " + dnum + " 天 ";
    document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()", 250);
</script>

<!-- 添加网站运行时间》-->

  </div>
  
 
  
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>














  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxuehua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao@master/source/js/dianjichuzi.js"></script>
<script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
